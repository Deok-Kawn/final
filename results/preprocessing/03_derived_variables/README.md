# Task 3.3: 핵심 파생 변수 생성

한국 전력 수요 예측을 위한 **핵심 5개 파생 변수**를 생성하였습니다.

## 📊 개요

- **입력 데이터**: 20개 컬럼 (날짜 + 전력수요 + 18개 시간피처)  
- **출력 데이터**: 25개 컬럼 (5개 파생변수 추가)
- **생성 방식**: 시계열 특성을 고려한 안전한 피처 엔지니어링

## 🎯 핵심 5개 파생 변수와 그 의미

### 1. `lag_1day` - 어제의 전력 수요
**🤔 왜 필요한가?**
- 전력 수요는 **관성**이 강합니다. 오늘이 특별히 춥거나 덥지 않다면, 어제와 비슷한 수요를 보입니다.
- **가장 직접적인 예측 신호**로, 대부분의 시계열 예측에서 핵심 피처입니다.

**📈 무엇을 의미하는가?**
- 단순히 "어제 사용한 전력량"
- 급격한 변화가 없는 평상시에는 **80% 이상의 예측력**을 제공

**🔍 실제 예시**:
- 어제 50,000MW → 오늘도 대략 50,000MW 근처일 확률이 높음
- 상관관계: **0.87** (매우 높음)

---

### 2. `lag_7day` - 지난주 같은 요일의 전력 수요
**🤔 왜 필요한가?**
- 전력 사용 패턴은 **요일별로 매우 다릅니다**:
  - 월요일: 공장 재가동으로 높은 수요
  - 수요일: 한 주 중 가장 높은 수요  
  - 일요일: 상업시설 휴무로 낮은 수요
- 지난주 같은 요일이 **가장 비슷한 조건**을 제공합니다.

**📈 무엇을 의미하는가?**
- "지난주 화요일에 얼마나 썼는지"가 "이번주 화요일" 예측의 핵심
- **계절성과 요일 패턴**을 동시에 포착

**🔍 실제 예시**:
- 지난주 월요일 55,000MW → 이번주 월요일도 55,000MW 근처 예상
- **최고 중요도**: 상관관계 **0.91** (5개 중 1위)

---

### 3. `rolling_7day_mean` - 최근 1주 평균
**🤔 왜 필요한가?**
- 개별 날짜는 **임시적 변동**이 있을 수 있습니다 (갑작스런 더위, 설비 점검 등)
- 최근 1주 평균은 **안정적인 단기 트렌드**를 보여줍니다.
- 급작스런 **이상치에 덜 민감**합니다.

**📈 무엇을 의미하는가?**
- "요즘 전력 사용량이 어느 수준인지"의 기준선
- 단기 상승/하락 트렌드 파악 가능

**🔍 실제 예시**:
- 최근 1주 평균이 52,000MW → 오늘도 이 근처에서 변동할 가능성
- 갑자기 60,000MW가 나온다면 → **특별한 이벤트** 발생 의심

---

### 4. `rolling_30day_mean` - 최근 1달 평균  
**🤔 왜 필요한가?**
- **계절적 변화**를 포착합니다:
  - 여름으로 갈수록 평균이 상승 (냉방 수요)
  - 겨울로 갈수록 평균이 상승 (난방 수요)
- 1주 평균보다 **더 안정적인 기준선**을 제공

**📈 무엇을 의미하는가?**
- "이 시기 평상시 전력 사용 수준"
- 오늘 수요가 **평상시 대비 높은지/낮은지** 판단 기준

**🔍 실제 예시**:
- 7월 1달 평균: 65,000MW (여름철 높은 기준)  
- 4월 1달 평균: 45,000MW (봄철 낮은 기준)
- 같은 55,000MW라도 7월에는 "평상시보다 낮음", 4월에는 "평상시보다 높음"

---

### 5. `daily_change` - 전일 대비 변화량
**🤔 왜 필요한가?**
- 전력 수요의 **변화 속도와 방향**을 파악합니다.
- 급격한 증가/감소 **트렌드의 지속성** 예측에 중요
- 이상 상황 조기 감지 가능

**📈 무엇을 의미하는가?**
- 양수(+): 수요 증가 추세
- 음수(-): 수요 감소 추세  
- 0 근처: 안정적 상태

**🔍 실제 예시**:
- +5,000MW: 급격한 수요 증가 (폭염 시작, 한파 시작)
- -3,000MW: 수요 감소 (날씨 좋아짐, 휴일 시작)
- ±500MW: 평상시 자연스러운 변동

## 📊 중요도 순위 (상관관계 기준)

| 순위 | 피처명 | 상관관계 | 의미 |
|------|--------|----------|------|
| 🥇 1위 | `lag_7day` | 0.914 | 지난주 같은 요일 (요일+계절 패턴) |
| 🥈 2위 | `rolling_7day_mean` | 0.871 | 최근 1주 트렌드 |
| 🥉 3위 | `lag_1day` | 0.870 | 어제 수요 (직접적 관성) |
| 4위 | `rolling_30day_mean` | 0.842 | 계절적 기준선 |
| 5위 | `daily_change` | 0.254 | 변화 방향 (보조 지표) |

## 🎯 예측에서의 활용법

### 일반적인 날 예측
```
예측값 = lag_7day × 0.4 + lag_1day × 0.3 + rolling_7day_mean × 0.2 + α
```

### 특수한 날 예측
- **휴일**: rolling_30day_mean 가중치 증가
- **폭염/한파**: daily_change로 급변 트렌드 반영
- **월요일**: lag_7day 가중치 최대화

## 💡 파생 변수의 핵심 가치

1. **예측 정확도 향상**: 단순 시간 피처만으로는 불가능한 **시간적 의존성** 포착
2. **모델 학습 가속**: 명시적으로 중요한 패턴을 제공하여 **학습 시간 단축**
3. **해석 가능성**: 각 피처의 의미가 명확하여 **예측 근거 설명** 가능
4. **안정성**: 과도한 피처 없이 **핵심만 선별**하여 과적합 방지

## 🔍 결측값 정보

| 피처명 | 결측값 수 | 이유 |
|--------|-----------|------|
| `lag_1day` | 1개 | 첫날 (2005-01-01) |
| `lag_7day` | 7개 | 첫 7일 (2005-01-01~07) |
| `rolling_7day_mean` | 1개 | 첫날 (시프트 적용) |
| `rolling_30day_mean` | 1개 | 첫날 (시프트 적용) |  
| `daily_change` | 1개 | 첫날 (변화량 계산 불가) |

**🚨 중요**: 결측값은 시계열 특성상 **자연스러운 현상**입니다. 모델 학습 시 이 부분은 제외하고 진행합니다.

---

**다음 단계**: Task 3.4에서 이 5개 파생 변수들을 포함한 전체 피처를 정규화하여 모델 학습에 최적화합니다. 